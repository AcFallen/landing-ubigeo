---
interface Props {
  baseUrl: string;
}
const { baseUrl } = Astro.props;
---

<section id="ep-buscar" class="px-4 py-8 md:px-8 md:py-10 lg:px-14 lg:py-12 max-w-[900px]">

  <div class="flex items-center gap-2.5 mb-3">
    <span class="text-[11px] font-bold px-2.5 py-[5px] rounded-[5px] bg-emerald-100 text-emerald-700 border border-emerald-200">GET</span>
    <code class="font-mono text-sm md:text-[15px] font-medium text-gray-900">/buscar</code>
  </div>
  <h2 class="text-lg md:text-[22px] font-bold text-gray-900 m-0 mb-2.5 tracking-tight">Buscar por nombre</h2>
  <p class="text-[13px] md:text-sm leading-relaxed text-gray-500 m-0 mb-6">
    Búsqueda de texto libre con soporte multi-palabra (<strong class="text-gray-700">AND</strong>), insensible a tildes y mayúsculas.
    Devuelve el árbol completo: distrito → provincia → departamento.
  </p>

  <div class="text-[13px] font-bold text-gray-900 mb-2.5">Query parameters</div>
  <div class="overflow-x-auto border border-gray-200 rounded-lg mb-6">
    <table class="w-full text-[13px] min-w-[520px]">
      <thead><tr>
        <th class="bg-gray-50 text-gray-400 font-semibold text-[11px] uppercase tracking-[0.06em] px-3.5 py-2.5 text-left border-b border-gray-200">Parámetro</th>
        <th class="bg-gray-50 text-gray-400 font-semibold text-[11px] uppercase tracking-[0.06em] px-3.5 py-2.5 text-left border-b border-gray-200">Tipo</th>
        <th class="bg-gray-50 text-gray-400 font-semibold text-[11px] uppercase tracking-[0.06em] px-3.5 py-2.5 text-left border-b border-gray-200">Requerido</th>
        <th class="bg-gray-50 text-gray-400 font-semibold text-[11px] uppercase tracking-[0.06em] px-3.5 py-2.5 text-left border-b border-gray-200">Default</th>
        <th class="bg-gray-50 text-gray-400 font-semibold text-[11px] uppercase tracking-[0.06em] px-3.5 py-2.5 text-left border-b border-gray-200">Descripción</th>
      </tr></thead>
      <tbody>
        <tr class="border-b border-gray-100">
          <td class="py-2.5 px-3.5"><code class="font-mono text-xs font-semibold text-gray-900">q</code></td>
          <td class="py-2.5 px-3.5"><span class="font-mono text-[11px] px-[7px] py-[2px] bg-violet-100 text-violet-700 rounded font-medium">string</span></td>
          <td class="py-2.5 px-3.5"><span class="text-[11px] px-[7px] py-[2px] bg-orange-50 text-peru rounded font-semibold">Sí</span></td>
          <td class="py-2.5 px-3.5 text-gray-400 text-xs">—</td>
          <td class="py-2.5 px-3.5 text-gray-500 text-xs">Texto de búsqueda (mín. 2 caracteres)</td>
        </tr>
        <tr>
          <td class="py-2.5 px-3.5"><code class="font-mono text-xs font-semibold text-gray-900">limit</code></td>
          <td class="py-2.5 px-3.5"><span class="font-mono text-[11px] px-[7px] py-[2px] bg-violet-100 text-violet-700 rounded font-medium">number</span></td>
          <td class="py-2.5 px-3.5"><span class="text-[11px] px-[7px] py-[2px] bg-gray-100 text-gray-500 rounded font-medium">No</span></td>
          <td class="py-2.5 px-3.5"><code class="font-mono text-xs bg-gray-100 px-1 rounded">20</code></td>
          <td class="py-2.5 px-3.5 text-gray-500 text-xs">Máximo de resultados a retornar</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Tester -->
  <div class="border border-gray-200 rounded-xl overflow-hidden mb-7">
    <div class="flex items-center gap-2 px-4 py-3 bg-gray-50 border-b border-gray-200 text-[13px] font-semibold text-gray-500">
      <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
      Probar endpoint
    </div>
    <div class="p-4">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-3">
        <div class="flex flex-col gap-1">
          <label class="flex items-center gap-1.5">
            <span class="text-xs font-bold text-gray-900 font-mono">q</span>
            <span class="text-[11px] px-[7px] py-0.5 rounded bg-orange-50 text-peru font-semibold">requerido</span>
          </label>
          <input type="text" id="input-buscar-q" class="w-full py-2 px-3 border border-gray-200 rounded-lg font-mono text-[13px] text-gray-900 bg-white outline-none focus:border-peru focus:ring-2 focus:ring-peru/10 transition-colors" placeholder="Ej: miraflores" />
          <span class="text-[11px] text-gray-400">Mínimo 2 caracteres</span>
        </div>
        <div class="flex flex-col gap-1">
          <label class="flex items-center gap-1.5">
            <span class="text-xs font-bold text-gray-900 font-mono">limit</span>
            <span class="text-[11px] px-[7px] py-0.5 rounded bg-gray-100 text-gray-500 font-medium">opcional</span>
          </label>
          <input type="number" id="input-buscar-limit" class="w-full py-2 px-3 border border-gray-200 rounded-lg font-mono text-[13px] text-gray-900 bg-white outline-none focus:border-peru focus:ring-2 focus:ring-peru/10 transition-colors" placeholder="20" min="1" max="100" />
          <span class="text-[11px] text-gray-400">Default: 20, máx: 100</span>
        </div>
      </div>
      <div class="flex items-center border border-gray-200 rounded-lg overflow-hidden bg-white">
        <span class="py-2.5 px-3.5 text-[11px] font-bold tracking-wider bg-emerald-50 text-emerald-700 border-r border-gray-200 shrink-0">GET</span>
        <div class="flex-1 px-3 py-2.5 font-mono text-xs text-gray-500 overflow-hidden text-ellipsis whitespace-nowrap">
          <span id="url-buscar">{baseUrl}/buscar?q=<span class="url-param">{'{q}'}</span></span>
        </div>
        <button class="flex items-center gap-1.5 px-4 py-2.5 bg-peru hover:bg-peru-dark text-white border-none text-[13px] font-semibold cursor-pointer shrink-0 transition-colors active:scale-[0.98]" data-endpoint="buscar">
          Enviar <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>
        </button>
      </div>
      <div class="hidden mt-3 border border-gray-200 rounded-lg overflow-hidden" id="resp-buscar">
        <div class="flex items-center gap-2.5 px-3.5 py-2 bg-gray-50 border-b border-gray-200 text-xs">
          <span class="font-bold text-xs px-2 py-0.5 rounded" id="status-buscar"></span>
          <span class="text-gray-400 mr-auto font-mono text-[11px]" id="time-buscar"></span>
          <button class="px-2.5 py-1 bg-white border border-gray-200 rounded text-[11px] font-medium text-gray-500 hover:border-peru hover:text-peru cursor-pointer transition-all" data-target="body-buscar">Copiar</button>
        </div>
        <div class="hidden resp-loading p-4 text-sm text-gray-400 bg-[#0D1117] gap-2.5" id="loading-buscar">
          <div class="spinner"></div><span>Enviando petición...</span>
        </div>
        <pre class="bg-[#0D1117] text-[#E6EDF3] m-0 p-4 font-mono text-[12.5px] leading-relaxed overflow-x-auto max-h-[400px] overflow-y-auto" id="body-buscar"></pre>
      </div>
    </div>
  </div>

  <div class="mb-4">
    <div class="text-[11px] font-semibold uppercase tracking-[0.05em] text-gray-400 mb-2">
      Ejemplo · <span class="text-emerald-600 font-bold normal-case">200 OK</span> · <code class="font-mono text-[11px] bg-gray-100 px-1 rounded">q=san isidro</code>
    </div>
    <pre class="bg-[#0D1117] border border-[#30363D] rounded-lg p-4 md:p-5 m-0 font-mono text-[12.5px] leading-relaxed text-[#E6EDF3] overflow-x-auto"><code>{"{"}}
  "query": "san isidro",
  "total": 3,
  "resultados": [
    {"{"}}
      "codigo":       "150131",
      "nombre":       "SAN ISIDRO",
      "provincia":    {"{"} "codigo": "1501", "nombre": "LIMA"     {"}"},
      "departamento": {"{"} "codigo": "15",   "nombre": "LIMA"     {"}"}
    {"}"},
    {"{"}}
      "codigo":       "040101",
      "nombre":       "SAN ISIDRO",
      "provincia":    {"{"} "codigo": "0401", "nombre": "AREQUIPA" {"}"},
      "departamento": {"{"} "codigo": "04",   "nombre": "AREQUIPA" {"}"}
    {"}"}
    <span class="code-comment">// ...</span>
  ]
{"}"}</code></pre>
  </div>
  <div>
    <div class="text-[11px] font-semibold uppercase tracking-[0.05em] text-gray-400 mb-2">
      Error · <span class="text-peru font-bold normal-case">400 Bad Request</span>
    </div>
    <pre class="bg-[#0D1117] border border-red-900/40 rounded-lg p-4 m-0 font-mono text-[12.5px] leading-relaxed text-[#E6EDF3] overflow-x-auto"><code>{"{"} "error": "El parámetro q debe tener al menos 2 caracteres" {"}"}</code></pre>
  </div>
</section>
